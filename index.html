<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gestor de Cron√≥metros</title>

<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #dbdace;
    color: #212121;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
  }

  h1 { 
    margin-bottom: 10px; 
    color: #111;
  }

  /* MENU LATERAL */
  #menu {
    position: fixed;
    top: 10px;
    right: 10px;
    left: auto;
    display: flex;
    gap: 10px;
  }

  #menu button {
    background: #0d3c91;
    border: none;
    color: #fff;
    padding: 8px 14px;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s;
  }

  #menu button:hover {
    background: #3b5fb3;
  }

  button {
    background: #0d3c91;
    border: none;
    color: #fff;
    padding: 8px 14px;
    margin: 4px;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s;
  }
  button:hover { background: #3b5fb3; }

  #timers-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    width: 90%;
    max-width: 900px;
  }

  .timer {
    background: #0d3c91;
    border: 1px solid #333;
    border-radius: 10px;
    padding: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    color: white;
  }

  .timer.completed {
    background: #164d16;
    border-color: #1d7a1d;
  }

  .timer h3 { margin: 5px 0; }
  .timer p { margin: 2px 0; }

  /* TIEMPO M√ÅS GRANDE */
  .timer p span {
    font-size: 1.7rem;
    font-weight: bold;
    color: #fff;
  }

  .timer .buttons {
    display: flex;
    gap: 6px;
  }

  .input-group {
    display: flex;
    gap: 5px;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 8px;
  }

  input, textarea {
    padding: 6px;
    border-radius: 5px;
    border: 1px solid #555;
    background: #181818;
    color: #eee;
  }

  textarea { resize: vertical; }

  #loginPanel {
    background: #1c1c1c;
    padding: 20px;
    border-radius: 10px;
    border: 1px solid #333;
    text-align: center;
    color: white;
  }

  #loginPanel input {
    width: 200px;
    margin: 5px 0;
  }

  .hidden { display: none; }

  /* P√°ginas internas */
  .page {
    display: none;
    width: 90%;
    max-width: 900px;
    margin-top: 20px;
  }

  .page.active {
    display: block;
  }

</style>
</head>

<body>

<div id="menu">
  <button onclick="openPage('timersPage')">‚è±Ô∏è Cron√≥metros</button>
  <button onclick="openPage('statsGeneral')">üìä Estad√≠sticas Generales</button>
  <button onclick="openPage('statsPersonal')">üìà Estad√≠sticas Personales</button>
</div>

<h1>Gestor de Cron√≥metros</h1>

<!-- LOGIN -->
<div id="loginPanel">
  <h2>Iniciar Sesi√≥n</h2>
  <input id="email" type="email" placeholder="Correo"><br>
  <input id="password" type="password" placeholder="Contrase√±a"><br>
  <button onclick="login()">Ingresar</button>
</div>

<!-- P√ÅGINA PRINCIPAL -->
<div id="timersPage" class="page">

  <div class="controls">
    <button onclick="addTimer()">‚ûï A√±adir cron√≥metro</button>
    <button onclick="resetAll()">üîÑ Reiniciar todos</button>
  </div>

  <div id="timers-container"></div>
</div>

<!-- P√ÅGINA: ESTAD√çSTICAS GENERALES -->
<div id="statsGeneral" class="page">
  <h2>Estad√≠sticas Generales</h2>
  <div id="statsGeneralEmbed">
    <!-- Aqu√≠ se inserta autom√°ticamente el iframe -->
  </div>
</div>

<!-- P√ÅGINA: ESTAD√çSTICAS PERSONALES -->
<div id="statsPersonal" class="page">
  <h2>Estad√≠sticas Personales</h2>
  <div id="statsPersonalEmbed">
    <!-- Aqu√≠ va el segundo iframe -->
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>

<script>
  /* -------------------------------
        CONFIGURAR FIREBASE AQU√ç
  -------------------------------- */
  const firebaseConfig = {
    apiKey: "TU_API_KEY",
    authDomain: "TU_AUTH_DOMAIN",
    databaseURL: "TU_DATABASE_URL",
    projectId: "TU_PROJECT",
    storageBucket: "TU_BUCKET",
    messagingSenderId: "TU_MSG",
    appId: "TU_APP_ID"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db   = firebase.database();

  let timers = [];
  let uid = null;

  /* ------------------------
       CAMBIO DE P√ÅGINAS
  ------------------------- */
  function openPage(id) {
    document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
    document.getElementById(id).classList.add("active");
  }

  /* ------------------------
       LOGIN
  ------------------------- */
  function login() {
    const email = emailInput.value;
    const pass = password.value;

    auth.signInWithEmailAndPassword(email, pass).then(res => {
      uid = res.user.uid;

      loginPanel.classList.add("hidden");
      openPage("timersPage");

      load();
      insertColabEmbeds();
    }).catch(err => {
      alert("Error: " + err.message);
    });
  }

  /* ------------------------
       CRUD DE CRON√ìMETROS
  ------------------------- */
  function addTimer() {
    const name = prompt("Nombre del cron√≥metro:");
    if (!name) return;
    const target = Number(prompt("Objetivo en minutos:"));
    if (!target || target < 1) return;

    timers.push({ name, target, elapsed: 0, running: false });
    save();
    renderTimers();
  }

  function renderTimers() {
    const cont = document.getElementById("timers-container");
    cont.innerHTML = "";

    timers.forEach((t, i) => {
      const div = document.createElement("div");
      div.className = "timer" + (t.elapsed >= t.target * 60000 ? " completed" : "");
      div.innerHTML = `
        <h3>${t.name}</h3>
        <p>Objetivo: ${t.target} min</p>
        <p>Tiempo: <span>${formatTime(t.elapsed)}</span></p>

        <div class="buttons">
          <button onclick="toggleTimer(${i})">‚ñ∂Ô∏è / ‚è∏Ô∏è</button>
          <button onclick="resetTimer(${i})">üîÑ</button>
          <button onclick="deleteTimer(${i})">üóëÔ∏è</button>
          <button onclick="editTimer(${i})">‚úèÔ∏è Editar</button>
        </div>
      `;
      cont.appendChild(div);
    });
  }

  window.editTimer = i => {
    const newTarget = prompt("Nuevo objetivo en minutos:", timers[i].target);
    if (!newTarget || isNaN(newTarget) || newTarget <= 0) return;
    timers[i].target = Number(newTarget);
    save();
    renderTimers();
  };

  function toggleTimer(i) {
    timers[i].running = !timers[i].running;
    save();
  }

  function resetTimer(i) {
    timers[i].elapsed = 0;
    timers[i].running = false;
    save();
    renderTimers();
  }

  function deleteTimer(i) {
    if (confirm("¬øEliminar este cron√≥metro?")) {
      timers.splice(i, 1);
      save();
      renderTimers();
    }
  }

  function resetAll() {
    if (!confirm("¬øReiniciar todos los cron√≥metros?")) return;
    timers.forEach(t => t.elapsed = 0);
    save();
    renderTimers();
  }

  function formatTime(ms) {
    const m = Math.floor(ms / 60000);
    const s = Math.floor((ms % 60000) / 1000);
    return m + ":" + (s < 10 ? "0" : "") + s;
  }

  /* ------------------------
        LOOP DEL CRON√ìMETRO
  ------------------------- */
  setInterval(() => {
    timers.forEach(t => {
      if (t.running) t.elapsed += 1000;
    });
    saveLocal();
    renderTimers();
  }, 1000);

  /* ------------------------
       CARGA Y GUARDADO
  ------------------------- */
  function save() {
    if (!uid) return;
    db.ref("usuarios/" + uid + "/cronometros").set(timers);
    saveLocal();
  }

  function saveLocal() {
    localStorage.setItem("timers", JSON.stringify(timers));
  }

  function load() {
    db.ref("usuarios/" + uid + "/cronometros").once("value").then(snap => {
      timers = snap.val() || [];
      renderTimers();
    });
  }

  /* ------------------------
       EMBED DE COLAB
  ------------------------- */
  function insertColabEmbeds() {
    document.getElementById("statsGeneralEmbed").innerHTML = `
      <iframe src="TU_URL_COLAB_GENERAL"
              width="100%" height="600px" style="border:none;"></iframe>
    `;

    document.getElementById("statsPersonalEmbed").innerHTML = `
      <iframe src="TU_URL_COLAB_PERSONAL"
              width="100%" height="600px" style="border:none;"></iframe>
    `;
  }

</script>

</body>
</html>

























